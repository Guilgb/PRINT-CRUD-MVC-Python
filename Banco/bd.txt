-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.agendamento
(
    id integer NOT NULL DEFAULT nextval('agendamento_id_seq'::regclass),
    data character varying(10) COLLATE pg_catalog."default" NOT NULL,
    horario time without time zone NOT NULL,
    pagamento character varying(20) COLLATE pg_catalog."default" NOT NULL,
    "observação" text COLLATE pg_catalog."default",
    animalid integer NOT NULL,
    funcionarioid integer NOT NULL,
    CONSTRAINT agendamento_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.animal
(
    id integer NOT NULL DEFAULT nextval('animal_id_seq'::regclass),
    nome character varying(80) COLLATE pg_catalog."default" NOT NULL,
    especie character varying(50) COLLATE pg_catalog."default" NOT NULL,
    sexo character varying(20) COLLATE pg_catalog."default" NOT NULL,
    raca character varying(30) COLLATE pg_catalog."default" NOT NULL,
    peso character varying(5) COLLATE pg_catalog."default" NOT NULL,
    nascimento character varying(10) COLLATE pg_catalog."default" NOT NULL,
    clienteid integer NOT NULL,
    CONSTRAINT animal_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.cliente
(
    id integer NOT NULL DEFAULT nextval('cliente_id_seq'::regclass),
    nome character varying(100) COLLATE pg_catalog."default" NOT NULL,
    cpf character varying(11) COLLATE pg_catalog."default" NOT NULL,
    nascimento character varying(10) COLLATE pg_catalog."default" NOT NULL,
    telefone character varying(10) COLLATE pg_catalog."default" NOT NULL,
    email character varying(50) COLLATE pg_catalog."default",
    rua character varying(100) COLLATE pg_catalog."default" NOT NULL,
    bairro character varying(80) COLLATE pg_catalog."default" NOT NULL,
    numero character varying(5) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT cliente_pkey PRIMARY KEY (id),
    CONSTRAINT cliente_cpf_key UNIQUE (cpf),
    CONSTRAINT cliente_email_key UNIQUE (email)
);

CREATE TABLE IF NOT EXISTS public.funcionario
(
    id integer NOT NULL DEFAULT nextval('funcionario_id_seq'::regclass),
    nome character varying(50) COLLATE pg_catalog."default" NOT NULL,
    nascimento character varying(15) COLLATE pg_catalog."default" NOT NULL,
    email character varying(50) COLLATE pg_catalog."default" NOT NULL,
    telefone character varying(15) COLLATE pg_catalog."default" NOT NULL,
    cargo character varying(30) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT funcionario_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.pertence
(
    vacinaid integer NOT NULL,
    prontuarioid integer NOT NULL
);

CREATE TABLE IF NOT EXISTS public.possui
(
    animalid integer NOT NULL,
    agendamentoid integer NOT NULL
);

CREATE TABLE IF NOT EXISTS public.prontuario
(
    id integer NOT NULL DEFAULT nextval('prontuario_id_seq'::regclass),
    raca character varying(20) COLLATE pg_catalog."default" NOT NULL,
    data character varying(15) COLLATE pg_catalog."default" NOT NULL,
    especie character varying(20) COLLATE pg_catalog."default" NOT NULL,
    porte character varying(20) COLLATE pg_catalog."default" NOT NULL,
    sexo character varying(15) COLLATE pg_catalog."default" NOT NULL,
    animalid integer NOT NULL,
    veterinarioid integer NOT NULL,
    CONSTRAINT prontuario_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.vacina
(
    id integer NOT NULL DEFAULT nextval('vacina_id_seq'::regclass),
    nome character varying(100) COLLATE pg_catalog."default" NOT NULL,
    validade character varying(10) COLLATE pg_catalog."default" NOT NULL,
    fabricante character varying(150) COLLATE pg_catalog."default" NOT NULL,
    volume character varying(15) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT vacina_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.veterinario
(
    id integer NOT NULL DEFAULT nextval('veterinario_id_seq'::regclass),
    nome character varying(100) COLLATE pg_catalog."default" NOT NULL,
    cpf character varying(11) COLLATE pg_catalog."default" NOT NULL,
    nascimento character varying(10) COLLATE pg_catalog."default" NOT NULL,
    telefone character varying(12) COLLATE pg_catalog."default" NOT NULL,
    email character varying(100) COLLATE pg_catalog."default" NOT NULL,
    formacao character varying(100) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT veterinario_pkey PRIMARY KEY (id),
    CONSTRAINT veterinario_cpf_key UNIQUE (cpf),
    CONSTRAINT veterinario_email_key UNIQUE (email)
);

ALTER TABLE IF EXISTS public.agendamento
    ADD CONSTRAINT id_fk_animal FOREIGN KEY (animalid)
    REFERENCES public.animal (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.agendamento
    ADD CONSTRAINT id_fk_funcionario FOREIGN KEY (funcionarioid)
    REFERENCES public.funcionario (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.animal
    ADD CONSTRAINT id_fk_cliente FOREIGN KEY (clienteid)
    REFERENCES public.cliente (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.pertence
    ADD CONSTRAINT id_fk_prontuario FOREIGN KEY (prontuarioid)
    REFERENCES public.prontuario (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.pertence
    ADD CONSTRAINT id_fk_vacina FOREIGN KEY (vacinaid)
    REFERENCES public.vacina (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.possui
    ADD CONSTRAINT id_fk_agendamento FOREIGN KEY (agendamentoid)
    REFERENCES public.agendamento (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.possui
    ADD CONSTRAINT id_fk_animal FOREIGN KEY (animalid)
    REFERENCES public.animal (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.prontuario
    ADD CONSTRAINT id_fk_animal FOREIGN KEY (animalid)
    REFERENCES public.animal (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.prontuario
    ADD CONSTRAINT id_fk_veterinario FOREIGN KEY (veterinarioid)
    REFERENCES public.veterinario (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;

END;